(this.webpackJsonpcowork=this.webpackJsonpcowork||[]).push([[1],{64:function(e,n,t){e.exports=t(93)},70:function(e,n,t){var o={"./ion-action-sheet.entry.js":[95,5],"./ion-alert.entry.js":[96,6],"./ion-app_8.entry.js":[97,7],"./ion-avatar_3.entry.js":[98,17],"./ion-back-button.entry.js":[99,18],"./ion-backdrop.entry.js":[100,43],"./ion-button_2.entry.js":[101,19],"./ion-card_5.entry.js":[102,20],"./ion-checkbox.entry.js":[103,21],"./ion-chip.entry.js":[104,22],"./ion-col_3.entry.js":[105,44],"./ion-datetime_3.entry.js":[106,10],"./ion-fab_3.entry.js":[107,23],"./ion-img.entry.js":[108,45],"./ion-infinite-scroll_2.entry.js":[109,46],"./ion-input.entry.js":[110,24],"./ion-item-option_3.entry.js":[111,25],"./ion-item_8.entry.js":[112,26],"./ion-loading.entry.js":[113,27],"./ion-menu_3.entry.js":[114,28],"./ion-modal.entry.js":[115,8],"./ion-nav_2.entry.js":[116,14],"./ion-popover.entry.js":[117,9],"./ion-progress-bar.entry.js":[118,29],"./ion-radio_2.entry.js":[119,30],"./ion-range.entry.js":[120,31],"./ion-refresher_2.entry.js":[121,11],"./ion-reorder_2.entry.js":[122,16],"./ion-ripple-effect.entry.js":[123,47],"./ion-route_4.entry.js":[124,32],"./ion-searchbar.entry.js":[125,33],"./ion-segment_2.entry.js":[126,34],"./ion-select_3.entry.js":[127,35],"./ion-slide_2.entry.js":[128,48],"./ion-spinner.entry.js":[129,13],"./ion-split-pane.entry.js":[130,49],"./ion-tab-bar_2.entry.js":[131,36],"./ion-tab_2.entry.js":[132,15],"./ion-text.entry.js":[133,37],"./ion-textarea.entry.js":[134,38],"./ion-toast.entry.js":[135,39],"./ion-toggle.entry.js":[136,12],"./ion-virtual-scroll.entry.js":[137,50]};function r(e){if(!t.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(o)},r.id=70,e.exports=r},72:function(e,n,t){var o={"./ion-icon.entry.js":[139,57]};function r(e){if(!t.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],r=n[0];return t.e(n[1]).then((function(){return t(r)}))}r.keys=function(){return Object.keys(o)},r.id=72,e.exports=r},77:function(e,n,t){},92:function(e,n,t){},93:function(e,n,t){"use strict";t.r(n);var o=t(2),r=t.n(o),a=t(38),c=t.n(a),i=t(31),s=t(25),l=t(4),u=t(59),d=t(7),m=t.n(d),p=t(16),h=(t(77),t(8)),f=t(9),y=t(142),g=t(47);t(80),t(81);g.a.initializeApp({apiKey:"AIzaSyDw0vg8LlwP9e5g9iKVMXOxQhBO_eO50LY",authDomain:"collaboration-109d2.firebaseapp.com",databaseURL:"https://collaboration-109d2-default-rtdb.firebaseio.com",projectId:"collaboration-109d2",storageBucket:"collaboration-109d2.appspot.com",messagingSenderId:"43770580592",appId:"1:43770580592:web:5d0e1672d6ecb447e9eeb5",measurementId:"G-QHFN2LCYER"});var j=function(){function e(){Object(h.a)(this,e),this.currentRemoteDescription=void 0,this.peerConnection=void 0,this.roomRef=void 0,this.db=void 0,this.channel=void 0,this.currentPeer=void 0,this.sub=void 0,this.connected=!1,this.peerConnection=new RTCPeerConnection,this.channel=this.peerConnection.createDataChannel("chat",{ordered:!0}),this.registerPeerConnectionListeners(),this.db=g.a.firestore(),this.sub=new y.a(this.connected)}return Object(f.a)(e,null,[{key:"createInstance",value:function(){return new e}},{key:"getInstance",value:function(){return e.instance||(e.instance=e.createInstance()),e.instance}}]),Object(f.a)(e,[{key:"sendMessage",value:function(e){e&&this.connected&&this.channel.send(e)}},{key:"roomChecking",value:function(){var e=Object(p.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.roomRef=this.db.collection("rooms").doc(n),e.next=3,this.roomRef.get();case 3:e.sent.exists?this.joinRoom():this.createRoom(n);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"createRoom",value:function(){var e=Object(p.a)(m.a.mark((function e(n){var t,o,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPeer="callerCandidates",e.next=3,this.peerConnection.createOffer();case 3:return t=e.sent,e.next=6,this.peerConnection.setLocalDescription(t);case 6:return this.channel.onmessage=function(e){console.log("onmessage==",e.data)},o={offer:{type:t.type,sdp:t.sdp}},e.next=10,this.db.collection("rooms").doc(n).set(o);case 10:return e.next=12,this.db.collection("rooms").doc(n);case 12:this.roomRef=e.sent,this.roomRef.onSnapshot(function(){var e=Object(p.a)(m.a.mark((function e(n){var t,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.data(),r.peerConnection.currentRemoteDescription||!t.answer){e.next=6;break}return o=new RTCSessionDescription(t.answer),e.next=5,r.peerConnection.setRemoteDescription(o);case 5:r.channel.onopen=function(e){return console.log("open!!!!")};case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),this.roomRef.collection("calleeCandidates").onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(p.a)(m.a.mark((function e(n){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=5;break}return t=n.doc.data(),console.log("Got new remote ICE candidate: ".concat(JSON.stringify(t))),e.next=5,r.peerConnection.addIceCandidate(new RTCIceCandidate(t));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}));case 15:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=Object(p.a)(m.a.mark((function e(){var n,t,o,r,a=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPeer="calleeCandidates",e.next=3,this.roomRef.get();case 3:return n=e.sent,t=n.data().offer,e.next=7,this.peerConnection.setRemoteDescription(t);case 7:return e.next=9,this.peerConnection.createAnswer();case 9:return o=e.sent,e.next=12,this.peerConnection.setLocalDescription(o);case 12:return this.peerConnection.ondatachannel=function(e){a.channel=e.channel,a.channel.onmessage=function(e){console.log("onmessage==",e.data)}},r={answer:{type:o.type,sdp:o.sdp}},e.next=16,this.roomRef.update(r);case 16:this.roomRef.collection("callerCandidates").onSnapshot((function(e){e.docChanges().forEach(function(){var e=Object(p.a)(m.a.mark((function e(n){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("added"!==n.type){e.next=5;break}return t=n.doc.data(),console.log("Got new remote ICE candidate: ".concat(JSON.stringify(t))),e.next=5,a.peerConnection.addIceCandidate(new RTCIceCandidate(t));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"registerPeerConnectionListeners",value:function(){var e=this;this.peerConnection.addEventListener("icegatheringstatechange",(function(){console.log("ICE gathering state changed: ".concat(e.peerConnection.iceGatheringState))})),this.peerConnection.addEventListener("connectionstatechange",(function(){console.log("Connection state change: ".concat(e.peerConnection.connectionState)),"connected"===e.peerConnection.connectionState?(e.connected=!0,e.sub.next(e.connected)):(e.connected=!1,e.sub.next(e.connected))})),this.peerConnection.addEventListener("icecandidate",function(){var n=Object(p.a)(m.a.mark((function n(t){var o;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=e.roomRef.collection(e.currentPeer),console.log(t.candidate),t.candidate&&o.add(t.candidate.toJSON());case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),this.peerConnection.addEventListener("signalingstatechange",(function(){console.log("Signaling state change: ".concat(e.peerConnection.signalingState))})),this.peerConnection.addEventListener("iceconnectionstatechange ",(function(){console.log("ICE connection state change: ".concat(e.peerConnection.iceConnectionState))}))}}]),e}();j.instance=null;var v=function(){var e=Object(s.e)(),n=j.getInstance(),t=Object(o.useState)(!1),a=Object(i.a)(t,2),c=a[0],u=a[1],d=Object(o.useState)(!1),h=Object(i.a)(d,2),f=h[0],y=h[1];Object(l.C)(Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("ionViewDidEnter event fired");case 1:case"end":return e.stop()}}),e)}))));return r.a.createElement(l.n,null,r.a.createElement(l.j,null,r.a.createElement(l.t,null,r.a.createElement(l.s,null,"Co-work"))),r.a.createElement(l.h,{fullscreen:!0},r.a.createElement(l.j,{collapse:"condense"},r.a.createElement(l.t,null,r.a.createElement(l.s,{size:"large"},"Co-work"))),r.a.createElement(l.a,{isOpen:!c,onDidDismiss:function(){return u(!0)},backdropDismiss:!1,cssClass:"my-custom-class",header:"Please enter room name",inputs:[{name:"name",type:"text",placeholder:"Enter room name"}],buttons:[{text:"Create or join",handler:function(t){if(!t.name)return!1;var o;o=t.name,e.push({pathname:"/home",search:"?room=".concat(o)}),n.roomChecking(o),n.sub.subscribe((function(e){y(e)}))}}]}),!f&&r.a.createElement("div",{className:"fullheight xc"},r.a.createElement(l.d,null,r.a.createElement(l.f,null,r.a.createElement(l.g,{color:"danger"},"No one's in the room ",r.a.createElement(l.r,{color:"warning"},"[",function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}("room"),"]"))),r.a.createElement(l.e,null,r.a.createElement("p",null,"Please ",r.a.createElement(l.r,{color:"warning"},"Wait "),", until someone ",r.a.createElement(l.r,{color:"success"},"Join ")),r.a.createElement("p",{className:"ion-margin-bottom"},"Invite your friend by sharing this link ",r.a.createElement(l.r,{className:"room-link",color:"primary"},window.location.href," ",r.a.createElement(l.c,{onClick:function(){var e=document.createElement("textarea");e.innerText=window.location.href,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()},className:"copy-button",size:"small",color:"primary"},"Copy link"))),r.a.createElement("p",null,"Or this room is ",r.a.createElement(l.r,{color:"danger"},"Dead "),", Please create another ",r.a.createElement(l.c,{onClick:function(){e.go(0)},fill:"outline",size:"small",color:"secondary"},"Create")))))))},b=(t(82),t(83),t(84),t(85),t(86),t(87),t(88),t(89),t(90),t(91),t(92),function(){var e=j.getInstance(),n=Object(o.useState)(),t=Object(i.a)(n,2),a=t[0],c=t[1];return r.a.createElement(l.b,null,r.a.createElement(u.a,null,r.a.createElement(l.q,{contentId:"main"},r.a.createElement(l.m,{side:"end",contentId:"main"},r.a.createElement(l.j,null,r.a.createElement(l.t,null,r.a.createElement(l.s,null,"Menu"))),r.a.createElement(l.h,{className:"ion-padding"},"sanidkpc"),r.a.createElement(l.i,null,r.a.createElement(l.t,null,r.a.createElement(l.l,{lines:"none"},r.a.createElement(l.k,{value:a,placeholder:"Enter Input",onIonChange:function(e){return c(e.detail.value)}}),r.a.createElement(l.c,{onClick:function(){e.sendMessage(a)},slot:"end"},"End"))))),r.a.createElement(l.p,{id:"main"},r.a.createElement(s.b,{path:"/home",component:v,exact:!0}),r.a.createElement(s.b,{exact:!0,path:"/",render:function(){return r.a.createElement(s.a,{to:"/home"})}})))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[64,3,4]]]);
//# sourceMappingURL=main.1b83232d.chunk.js.map